import csv, sqlite3
import datetime
import random
import time

while True:
    
    mRIDList = ['\x10\x00\x00\x00\x00\x00\x00\x34\x10\x00\x00\x00\x00\x00\x00\x01', '\x10\x00\x00\x00\x00\x00\x00\x34\x10\x00\x00\x00\x00\x00\x00\x02', '\x10\x00\x00\x00\x00\x00\x00\x34\x10\x00\x00\x00\x00\x00\x00\x03',\
                '\x10\x00\x00\x00\x00\x00\x00\x34\x10\x00\x00\x00\x00\x00\x00\x04', '\x10\x00\x00\x00\x00\x00\x00\x34\x10\x00\x00\x00\x00\x00\x00\x05', '\x10\x00\x00\x00\x00\x00\x00\x34\x10\x00\x00\x00\x00\x00\x00\x06',\
                '\x10\x00\x00\x00\x00\x00\x00\x34\x10\x00\x00\x00\x00\x00\x00\x07', '\x10\x00\x00\x00\x00\x00\x00\x34\x10\x00\x00\x00\x00\x00\x00\x08', '\x10\x00\x00\x00\x00\x00\x00\x34\x10\x00\x00\x00\x00\x00\x00\x09',\
                '\x10\x00\x00\x00\x00\x00\x00\x34\x10\x00\x00\x00\x00\x00\x00\x0a']
    con = sqlite3.connect("TAdb.db")
    cur = con.cursor()
    for mrid in mRIDList:
        power = round(random.uniform(700, 1600),2)
        credit = random.randint(900,1150)
        mrid = mrid.encode('hex')
        to_db_power = [(datetime.datetime.now()).strftime('%Y-%m-%d %H:%M:%S'), mrid, power]
        to_db_credit = [(datetime.datetime.now()).strftime('%Y-%m-%d %H:%M:%S'), mrid, credit]
        cur.execute("INSERT INTO power (Date, mRID, Power) VALUES (?, ?, ?);", to_db_power)
        cur.execute("INSERT INTO credit (Date, mRID, credit) VALUES (?, ?, ?);", to_db_credit)
    con.commit()    
    con.close()
    print 'New record is inserted'
    time.sleep(3600)
    
